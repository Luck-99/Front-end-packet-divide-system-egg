"use strict";(self["webpackChunkvue_test"]=self["webpackChunkvue_test"]||[]).push([[93],{8093:function(e,s,o){o.r(s),o.d(s,{default:function(){return k}});var t=function(){var e=this,s=e._self._c;return s("div",[s("Header"),s("router-view")],1)},a=[],r=function(){var e=this,s=e._self._c;return s("header",{staticClass:"main-header borderBottom"},[s("div",{staticClass:"main-header-title"},[e._v(e._s(e.title))]),s("el-dropdown",{attrs:{trigger:"click"},on:{command:e.handleUserClick}},[s("div",{staticClass:"main-header-avatar"},[s("el-avatar",{attrs:{src:e.userInfo?.avaUrl??e.defaultAvaUrl,size:"small"}}),s("span",{staticStyle:{"margin-left":"7px"}},[e._v(e._s(e.userInfo?.name))])],1),s("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[s("el-dropdown-item",{attrs:{icon:"el-icon-edit",command:"changePassWord"}},[e._v("修改密码")]),s("el-dropdown-item",{attrs:{icon:"el-icon-switch-button",divided:"",command:"logout"}},[e._v("注销")])],1)],1),s("change-pass-word",{ref:"changePassWordRef"})],1)},l=[],n=o(9195),i=function(){var e=this,s=e._self._c;return e.dialog.visible?s("el-dialog",{attrs:{title:e.dialog.title,visible:e.dialog.visible,width:e.dialog.width,"close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!1,"destroy-on-close":!0,"append-to-body":""}},[s("el-form",{ref:"passWordFrom",attrs:{model:e.dialog,rules:e.passWordFromRules}},[s("el-form-item",{attrs:{prop:"oldPassWord",label:"原密码：","label-width":e.dialog.labelWidth}},[s("el-input",{attrs:{type:"password"},model:{value:e.dialog.oldPassWord,callback:function(s){e.$set(e.dialog,"oldPassWord",s)},expression:"dialog.oldPassWord"}})],1),s("el-form-item",{attrs:{prop:"newPassWord",label:"新密码：","label-width":e.dialog.labelWidth}},[s("el-input",{attrs:{type:"password"},model:{value:e.dialog.newPassWord,callback:function(s){e.$set(e.dialog,"newPassWord",s)},expression:"dialog.newPassWord"}})],1),s("el-form-item",{attrs:{prop:"confirmPassWord",label:"确认密码：","label-width":e.dialog.labelWidth}},[s("el-input",{attrs:{type:"password"},model:{value:e.dialog.confirmPassWord,callback:function(s){e.$set(e.dialog,"confirmPassWord",s)},expression:"dialog.confirmPassWord"}})],1)],1),s("div",{attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(s){return e.cloneDialog()}}},[e._v("取 消")]),s("el-button",{attrs:{type:"primary"},on:{click:function(s){return e.changePassWord()}}},[e._v("确 定")])],1)],1):e._e()},d=[],c={name:"ChangePassWord",data(){return{dialog:{title:"修改密码",width:"500px",visible:!1,labelWidth:"100px",oldPassWord:"",newPassWord:"",confirmPassWord:""},passWordFromRules:{oldPassWord:[{required:!0,trigger:"blur",message:"原密码必填"}],newPassWord:[{required:!0,trigger:"blur",message:"新密码必填"}],confirmPassWord:[{required:!0,trigger:"blur",message:"确认密码必填"}]}}},methods:{changePassWord(){const{oldPassWord:e,newPassWord:s,confirmPassWord:o}=this.dialog;this.$refs["passWordFrom"].validate((async t=>{if(!t)return!1;if(s!==o)this.$message.error("两次密码输入不一致！");else{const o=await(0,n.bs)({oldPassWord:e,newPassWord:s});o.code>0?(this.$message.success(o.msg),this.cloneDialog()):this.$message.error(o.msg)}}))},cloneDialog(){this.dialog.visible=!1,this.$refs["passWordFrom"].resetFields()}}},u=c,m=o(1001),g=(0,m.Z)(u,i,d,!1,null,null,null),f=g.exports,h={components:{ChangePassWord:f},name:"Header",data(){return{defaultAvaUrl:"https://cube.elemecdn.com/3/7c/3ea6beec64369c2642b92c6726f1epng.png",title:"分组分治打包系统",userInfo:this.$store.getters.userInfo,dialogVisible:!1}},methods:{async getUserInfo(){const e=await(0,n.bG)();e.code>0&&(this.userInfo=e.data,this.$store.commit("setUserInfo",e.data))},async logout(){const e=await(0,n.kS)();e.code>0&&(sessionStorage.getItem("front-end-packet-divide-system-store")&&sessionStorage.removeItem("front-end-packet-divide-system-store"),this.$router.replace("/login"))},handleUserClick(e){switch(e){case"logout":return this.logout();case"changePassWord":return void(this.$refs.changePassWordRef.dialog.visible=!0);default:break}}},created(){this.getUserInfo()}},p=h,W=(0,m.Z)(p,r,l,!1,null,"06aafef1",null),b=W.exports,v={name:"main",components:{Header:b}},P=v,w=(0,m.Z)(P,t,a,!1,null,null,null),k=w.exports},9195:function(e,s,o){o.d(s,{Zw:function(){return l},bG:function(){return n},bs:function(){return i},kS:function(){return r},x4:function(){return a}});var t=o(7861);const a=async e=>(0,t.W)("/user/login",{method:"POST",data:e}),r=async e=>(0,t.W)("/user/logout",{method:"POST",data:e}),l=async e=>(0,t.W)("/user/getMembers",{method:"GET",params:e}),n=async e=>(0,t.W)("/user/getUserInfo",{method:"GET",params:e}),i=async e=>(0,t.W)("/user/changePassWord",{method:"POST",data:e})}}]);